{"startSite": "", "filingNum": "", "onePageListNum": 15, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "dayTheme": "light", "nightTheme": "dark_colorblind", "urlMode": "pinyin", "script": "", "style": "", "bottomText": "\u2764\ufe0f \u8f6c\u8f7d\u6587\u7ae0\u8bf7\u6ce8\u660e\u51fa\u5904\uff0c\u8c22\u8c22\uff01\u2764\ufe0f", "showPostSource": 1, "title": "\u4e00\u53ea\u535a\u5ba2", "displayTitle": "\u4e00\u53ea\u535a\u5ba2", "subTitle": "\u7528\u6811\u6728\u53bb\u63a5\u8fd1\u661f\u8fb0\u662f\u5927\u5730\u7684\u68a6\u60f3\u3002", "homeUrl": "https://fluent12138.github.io/", "avatarUrl": "https://cdn.acwing.com/media/article/image/2023/05/28/36510_044ec922fc-3.png", "faviconUrl": "https://cdn.acwing.com/media/article/image/2023/05/28/36510_044ec922fc-3.png", "singlePage": ["link", "about"], "email": "fluent12138@163.com", "GMEEK_VERSION": "main", "postListJson": {"P4": {"htmlDir": "docs/post/erlang-gen_fsm -you-xi-jiao-yi.html", "label": "done", "labelColor": "#334200", "postTitle": "erlang-gen_fsm \u6e38\u620f\u4ea4\u6613", "postUrl": "post/erlang-gen_fsm%20-you-xi-jiao-yi.html", "postSourceUrl": "https://github.com/fluent12138/fluent12138.github.io/issues/4", "commentNum": 0, "description": "![fsm-\u6e38\u620f\u4ea4\u6613.excalidraw.png](https://cdn.acwing.com/media/article/image/2023/04/04/36510_86007705d2-fsm-\u6e38\u620f\u4ea4\u6613.excalidraw.png)\r\n\r\n **code** \r\n \r\n```\r\n%%%-------------------------------------------------------------------\r\n%%% @author \u52d2\u52d2\r\n%%% @copyright (C) 2023, <COMPANY>\r\n%%% @doc\r\n%%%\r\n%%% @end\r\n%%% Created : 31. 3\u6708 2023 14:38\r\n%%%-------------------------------------------------------------------\r\n-module(trade_fsm).\r\n-author(\"\u52d2\u52d2\").\r\n-behavior(gen_fsm).\r\n-record(state, {name = \"\", other, ownitems = [], otheritems = [], monitor, from}). % from\u5c31\u662fgen_fsm\u4e2d\u53d1\u9001\u6d88\u606f\u5904\r\n%% \u516c\u5171API\r\n-export([start/1, start_link/1, trade/2, accept_trade/1, make_offer/2, retract_offer/2, ready/1, cancel/1]).\r\n%% gen_sfm\u56de\u8c03\u51fd\u6570\r\n-export([init/1, handle_event/3, handle_sync_event/4, handle_info/3, terminate/3, code_change/4,\r\n        % \u5b9a\u5236\u7684\u72b6\u6001\u540d\r\n        idle/2, idle/3, idle_wait/2, idle_wait/3, negotiate/2, negotiate/3, wait/2, ready/2, ready/3\r\n        ]).\r\n\r\n%%% \u516c\u5171API\r\nstart(Name) -> gen_fsm:start(?MODULE, [Name], []).\r\n\r\nstart_link(Name) -> gen_fsm:start_link(?MODULE, [Name], []).\r\n\r\n%% \u8bf7\u6c42\u5f00\u59cb\u4ea4\u6613\u8c08\u8bdd. \u5f53/\u5982\u679c\u5bf9\u65b9\u63a5\u6536\u65f6\u8fd4\u56de\r\ntrade(OwnPid, OtherPid) ->\r\n  gen_fsm:sync_send_event(OwnPid, {negotiate, OtherPid}, 30000).\r\n\r\n%% \u63a5\u6536\u67d0\u4e2a\u73a9\u5bb6\u7684\u4ea4\u6613\u8bf7\u6c42\r\naccept_trade(OwnPid) ->\r\n  gen_fsm:sync_send_event(OwnPid, accept_negotiate).\r\n\r\n%% \u4ece\u7269\u54c1\u5217\u8868\u4e2d\u9009\u62e9\u4e00\u4e2a\u8fdb\u884c\u4ea4\u6613\r\nmake_offer(OwnPid, Item) ->\r\n  gen_fsm:send_event(OwnPid, {make_offer, Item}).\r\n\r\n%% \u64a4\u9500\u67d0\u4e2a\u4ea4\u6613\u7269\u54c1\r\nretract_offer(OwnPid, Item) ->\r\n  gen_fsm:send_event(OwnPid, {retract_offer, Item}).\r\n\r\n%% \u5ba3\u5e03\u81ea\u5df1\u5c31\u7eea. \u5f53\u5bf9\u65b9\u4e5f\u5ba3\u5e03\u81ea\u5df1\u5c31\u7eea\u4e86, \u4ea4\u6613\u5c31\u5b8c\u6210\u4e86.\r\nready(OwnPid) ->\r\n  gen_fsm:sync_send_event(OwnPid, ready, infinity).\r\n\r\n%% \u53d6\u6d88\u4ea4\u6613\r\ncancel(OwnPid) ->\r\n  gen_fsm:sync_send_all_state_event(OwnPid, cancel).\r\n\r\n%%% FSM \u5230 FSM\r\n\r\n%% \u5411\u53e6\u4e00\u4e2aFSM\u53d1\u9001\u4ea4\u6613\u4f1a\u8bdd\u8bf7\u6c42\r\nask_negotiate(OwnPid, OtherPid) ->\r\n  gen_fsm:send_event(OtherPid, {ask_negotiate, OwnPid}).\r\n\r\n%% \u8f6c\u53d1\u73a9\u5bb6\u4ea4\u6613\u63a5\u6536\u8bf7\u6c42\r\naccept_negotiate(OtherPid, OwnPid) ->\r\n  gen_fsm:send_event(OtherPid, {accept_negotiate, OwnPid}).\r\n\r\n%% \u8f6c\u53d1\u73a9\u5bb6\u7684\u4ea4\u6613\u7269\u54c1\u63d0\u4f9b\u4fe1\u606f\r\ndo_offer(OtherPid, Item) ->\r\n  gen_fsm:send_event(OtherPid, {do_offer, Item}).\r\n\r\n%% \u8f6c\u53d1\u73a9\u5bb6\u4ea4\u6613\u7269\u54c1\u64a4\u9500\u8bf7\u6c42\r\nundo_offer(OtherPid, Item) ->\r\n  gen_fsm:send_event(OtherPid, {undo_offer, Item}).\r\n\r\n%% \u8be2\u95ee\u5bf9\u65b9\u662f\u5426\u5c31\u7eea\r\nare_you_ready(OtherPid) ->\r\n  gen_fsm:send_event(OtherPid, are_you_ready).\r\n\r\n%% \u56de\u590d\u672a\u5c31\u7eea -> \u4e0d\u5728wait\u72b6\u6001\u54e6\r\nnot_yet(OtherPid) ->\r\n  gen_fsm:send_event(OtherPid, not_yet).\r\n\r\n%% \u901a\u77e5\u5bf9\u65b9\u73a9\u5bb6\u5f53\u524d\u5904\u4e8e\u7b49\u5f85\u8fdb\u5165ready\u72b6\u6001\r\n%% \u72b6\u6001\u4f1a\u8fc1\u79fb\u5230ready ?\r\nam_ready(OtherPid) ->\r\n  gen_fsm:send_event(OtherPid, 'ready!').\r\n\r\n%% \u786e\u8ba4fsm\u5904\u4e8eready\u72b6\u6001\r\nack_trans(OtherPid) ->\r\n  gen_fsm:send_event(OtherPid, ack).\r\n\r\n%% \u8be2\u95ee\u662f\u5426\u53ef\u4ee5\u63d0\u4ea4\r\nask_commit(OtherPid) ->\r\n  gen_fsm:sync_send_event(OtherPid, ask_commit).\r\n\r\n%% \u5f00\u59cb\u540c\u6b65\u63d0\u4ea4\r\ndo_commit(OtherPid) ->\r\n  gen_fsm:sync_send_event(OtherPid, do_commit).\r\n\r\n%% \u793c\u8c8c\u53d6\u6d88\r\nnotify_cancel(OtherPid) ->\r\n  gen_fsm:send_all_state_event(OtherPid, cancel).\r\n\r\ninit(Name) ->\r\n  {ok, idle, #state{name = Name}}.\r\n\r\n%% \u7ed9\u73a9\u5bb6\u53d1\u9001\u4e00\u6761\u901a\u77e5, \u53ef\u4ee5\u662f\u4e00\u6761\u53d1\u7ed9\u73a9\u5bb6\u8fdb\u7a0b\u7684\u6d88\u606f\r\n%% \u6253\u5370\u5728\u63a7\u5236\u53f0\u5c31ok\u4e86\r\nnotice(#state{name = N}, Str, Args) ->\r\n  io:format(\"~s : \"++ Str ++ \"~n\", [N | Args]).\r\n\r\n%% \u8bb0\u5f55\u975e\u671f\u671b\u7684\u6d88\u606f\r\nunexpected(Msg, State) ->\r\n  io:format(\"~p receive unknown event ~p while in state ~p\", [self(), Msg, State]).\r\n\r\n%%% idle \u8bf7\u6c42/\u63a5\u6536 \u4ea4\u6613\r\n%% \u5f02\u6b65\u7248\u672c, \u5173\u5fc3\u5176\u4ed6\u73a9\u5bb6\u7684\u4ea4\u6613\u8bf7\u6c42\r\nidle({ask_negotiate, OtherPid}, S = #state{}) ->\r\n  Ref = monitor(process, OtherPid),\r\n  notice(S, \"~p asked for a trade negotiation\", [OtherPid]),\r\n  {next_state, idle_wait, S#state{other = OtherPid, monitor = Ref}};\r\n\r\nidle(Event, Data) ->\r\n  unexpected(Event, idle),\r\n  {next_state, idle, Data}.\r\n\r\n%% \u540c\u6b65\u7248\u672c, \u672c\u65b9\u73a9\u5bb6\u8bf7\u6c42\u53e6\u4e00\u4e2a\u73a9\u5bb6\u8fdb\u884c\u4ea4\u6613\r\nidle({negotiate, OtherPid}, From, S=#state{}) ->\r\n  ask_negotiate(OtherPid, self()),\r\n  notice(S, \"asking user ~p for a trade\", [OtherPid]),\r\n  Ref = monitor(process, OtherPid),\r\n  {next_state, idle_wait, S = #state{other = OtherPid, monitor = Ref, from = From}};\r\n\r\nidle(Event, _From, Data) ->\r\n  unexpected(Event, idle),\r\n  {next_state, idle, Data}.\r\n\r\n%%% idle_wait\r\n%% \u63a5\u6536\u65b9, 1.\u540c\u610f\u534f\u5546 2.\u5728\u6211\u4eec\u53d1\u9001\u4ea4\u6613\u8bf7\u6c42\u65f6, \u4ed6\u4e5f\u53d1\u8d77\u4e86\u4ea4\u6613\r\nidle_wait({ask_negotiate, OtherPid}, S = #state{other = OtherPid}) ->\r\n  gen_fsm:reply(S#state.from, ok), % \u901a\u77e5\u73a9\u5bb6\u4e00\u5207\u6b63\u5e38\r\n  notice(S, \"starting negotiation\", []),\r\n  {next_state, negotiate, S};\r\n\r\n%% \u5bf9\u65b9\u63a5\u53d7\u4e86\u6211\u4eec\u7684\u8bf7\u6c42, \u8fc1\u79fbnegotiate\u72b6\u6001\r\nidle_wait({accept_negotiate, OtherPid}, S = #state{other = OtherPid}) ->\r\n  gen_fsm:reply(S#state.from, ok), % \u901a\u77e5\u73a9\u5bb6\u4e00\u5207\u6b63\u5e38\r\n  notice(S, \"starting negotiation\", []),\r\n  {next_state, negotiate, S};\r\n\r\nidle_wait(Event, Data) ->\r\n  unexpected(Event, idle_wait),\r\n  {next_state, idle_wait, Data}.\r\n\r\n%% \u53d1\u9001\u65b9, \u63a5\u6536\u5bf9\u65b9\u73a9\u5bb6\u8bf7\u6c42\r\nidle_wait(accept_negotiate, _From, S = #state{other = OtherPid}) ->\r\n  accept_negotiate(OtherPid, self()),\r\n  notice(S, \"accepting negotiation\", []),\r\n  {reply, ok, negotiate, S};\r\n\r\nidle_wait(Event, _From, Data) ->\r\n  unexpected(Event, idle_wait),\r\n  {next_state, idle_wait, Data}.\r\n\r\n%% \u5411\u7269\u54c1\u5217\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u7269\u54c1\r\nadd(Item, Items) ->\r\n  [Item|Items].\r\n\r\n%% \u4ece\u7269\u54c1\u5217\u8868\u4e2d\u5220\u9664\u4e00\u4e2a\u7269\u54c1\r\nremove(Item, Items) ->\r\n  Items -- [Item].\r\n\r\n%%% negotiate\r\n%% \u672c\u65b9\u63d0\u4f9b\u7269\u54c1\r\nnegotiate({make_offer, Item}, S = #state{ownitems = OwnItems}) ->\r\n  do_offer(S#state.other, Item),\r\n  notice(S, \"offering ~p\", [Item]),\r\n  {next_state, negotiate, S#state{ownitems = add(Item, OwnItems)}};\r\n\r\n%% \u672c\u65b9\u64a4\u9500\u7269\u54c1\r\nnegotiate({retract_offer, Item}, S = #state{ownitems = OwnItems}) ->\r\n  undo_offer(S#state.other, Item),\r\n  notice(S, \"cancelling offer on ~p\", [Item]),\r\n  {next_state, negotiate, S#state{ownitems = remove(Item, OwnItems)}};\r\n\r\n%% \u5bf9\u65b9\u63d0\u4f9b\u7269\u54c1\r\nnegotiate({do_offer, Item}, S = #state{otheritems = OtherItems}) ->\r\n  notice(S, \"other player offering ~p\", [Item]),\r\n  {next_state, negotiate, S#state{otheritems = add(Item, OtherItems)}};\r\n\r\n%% \u5bf9\u65b9\u64a4\u9500\u7269\u54c1\r\nnegotiate({undo_offer, Item}, S = #state{otheritems = OtherItems}) ->\r\n  notice(S, \"other player cancelling offer on ~p\", [Item]),\r\n  {next_state, negotiate, S#state{otheritems = OtherItems}};\r\n\r\n%% \u5f53\u5728negotiate\u72b6\u6001\u65f6, \u63a5\u6536\u5230\u5bf9\u65b9\u7684ready\u4fe1\u53f7, \u76f4\u63a5\u62d2\u7edd.\r\nnegotiate(are_you_ready, S = #state{other = OtherPid}) ->\r\n  io:format(\"Other user ready to trade ~n\"),\r\n  notice(S, \"Other user ready to transfer goods : ~n You get ~p, The Other side gets ~p\", [S#state.otheritems, S#state.ownitems]),\r\n  not_yet(OtherPid),\r\n  {next_state, negotiate, S};\r\n\r\nnegotiate(Event, Data) ->\r\n  unexpected(Event, negotiate),\r\n  {next_state, negotiate, Data}.\r\n\r\n%% \u73a9\u5bb6\u505a\u5b8c\u51b3\u7b56 -> \u53d1\u9001ready\r\nnegotiate(ready, From, S = #state{other = OtherPid}) ->\r\n  are_you_ready(OtherPid),\r\n  notice(S, \"asking if ready, waiting\", []),\r\n  {next_state, wait, S = #state{from = From}};\r\n\r\nnegotiate(Event, _From, S) ->\r\n  unexpected(Event, negotiate),\r\n  {next_state, negotiate, S}.\r\n\r\n%%% wait\r\n\r\n%% \u5f53\u5bf9\u65b9\u64a4\u9500/\u63d0\u4f9b\u7269\u54c1\u4e86, \u56de\u9000\u5230negotiate\u72b6\u6001\r\nwait({do_offer, Item}, S = #state{otheritems = OtherItems}) ->\r\n  gen_fsm:reply(S#state.from, offer_changed), % \u901a\u77e5negotiate\u72b6\u6001\r\n  notice(S, \"other side offering ~p\", [Item]),\r\n  {next_state, negotiate, S#state{otheritems = add(Item, OtherItems)}};\r\n\r\nwait({undo_offer, Item}, S = #state{otheritems = OtherItems}) ->\r\n  gen_fsm:reply(S#state.from, offer_changed), % \u901a\u77e5negotiate\u72b6\u6001\r\n  notice(S, \"other side cancelling offer of ~p\", [Item]),\r\n  {next_state, negotiate, S#state{otheritems = remove(Item, OtherItems)}};\r\n\r\n%% \u5bf9\u65b9\u8be2\u95ee\u672c\u65b9\u662f\u5426ready\r\nwait(are_you_ready, S = #state{}) ->\r\n  am_ready(S#state.other),\r\n  notice(S, \"asked if ready, and I am. Waiting for same reply\", []),\r\n  {next_state, wait, S};\r\n\r\n%% \u5bf9\u65b9\u4e0d\u540c\u610f\r\nwait(not_yet, S = #state{}) ->\r\n  notice(S, \"Other not ready yet\", []),\r\n  {next_state, wait, S};\r\n\r\n%% \u6536\u5230ready!\r\nwait('ready!', S = #state{}) ->\r\n  am_ready(S#state.other),\r\n  ack_trans(S#state.other),\r\n  gen_fsm:reply(#state.from, ok),\r\n  notice(S, \"other side is ready. Moving to ready state\", []),\r\n  {next_state, ready, S};\r\n\r\n%% \u4e0d\u671f\u5f85\u7684\u6d88\u606f\r\nwait(Event, Data) ->\r\n  unexpected(Event, wait),\r\n  {next_state, wait, Data}.\r\n\r\n%%% ready, \u9009\u62e9\u4e00\u4e2aFSM\u53bb\u5b8c\u6210ready, erlang\u4e2d\u8fdb\u7a0b\u662f\u6392\u597d\u5e8f\u7684, \u53ef\u4ee5\u6bd4\u8f83\u5927\u5c0f\r\npriority(OwnPid, OtherPid) when OwnPid > OtherPid -> true;\r\npriority(OwnPid, OtherPid) when OtherPid > OwnPid -> false.\r\n\r\nready(ack, S = #state{}) ->\r\n  case priority(self(), S#state.other) of\r\n      true ->\r\n        try\r\n          notice(S, \"asking for commit\", []),\r\n          ready_commit = ask_commit(S#state.other),\r\n          notice(S, \"ordering commit\", []),\r\n          ok = do_commit(S#state.other),\r\n          commit(S),\r\n          {stop, normal, S}\r\n        catch Class:Reason ->\r\n          %% \u9000\u51fa!, ready_commit\u6216do_commit\u5931\u8d25\u4e86\r\n          notice(S, \"commit failed\", []),\r\n          {stop, {Class, Reason}, S}\r\n        end;\r\n      false ->\r\n        {next_state, ready, S}\r\n  end;\r\n\r\nready(Event, Data) ->\r\n  unexpected(Event, ready),\r\n  {next_state, ready, Data}.\r\n\r\nready(ask_commit, _From, S) ->\r\n  notice(S, \"replying to ask_commit\", []),\r\n  {reply, ready_commit, ready, S};\r\n\r\nready(do_commit, _From, S) ->\r\n  notice(S, \"commiting...\", []),\r\n  commit(S),\r\n  {stop, normal, ok, S};\r\n\r\nready(Event, _From, S) ->\r\n  unexpected(Event, ready),\r\n  {next_state, ready, S}.\r\n\r\ncommit(S = #state{}) ->\r\n  io:format(\"Transaction completed for ~s.\", [S#state.name]),\r\n  io:format(\"Items send are: ~n ~p ~n received are: ~n ~p ~n\", [S#state.ownitems, S#state.otheritems]),\r\n  io:format(\"The operation should have some atomic save in a database\").\r\n\r\n%% \u5bf9\u65b9\u73a9\u5bb6\u53d6\u6d88\u4ea4\u6613\r\n%% \u505c\u6b62\u6b63\u518d\u505a\u7684\u5de5\u4f5c \u7ec8\u6b62\u8fdb\u7a0b\r\nhandle_event(cancel, _StateName, S = #state{}) ->\r\n  notice(S, \"received cancel event\", []),\r\n  {stop, other_cancelled, S};\r\n\r\nhandle_event(Event, StateName, Data) ->\r\n  unexpected(Event, StateName),\r\n  {next_state, StateName, Data}.\r\n\r\n%% \u672c\u65b9\u73a9\u5bb6\u7ec8\u6b62\u4ea4\u6613, \u5fc5\u987b\u901a\u77e5\u5bf9\u65b9\u73a9\u5bb6\u6211\u4eec\u9000\u51fa\u4e86\r\nhandle_sync_event(cancel, _From, _StateName, S = #state{}) ->\r\n  notify_cancel(S#state.other),\r\n  notice(S, \"cancelling trade, sending cancel event\", []),\r\n  {stop, cancelled, ok, S};\r\n\r\nhandle_sync_event(Event, _From, StateName, Data) ->\r\n  unexpected(Event, StateName),\r\n  {next_state, StateName, Data}.\r\n\r\n%% \u5904\u7406\u5bf9\u65b9FSM\u5d29\u6e83\u4e8b\u4ef6\r\nhandle_info({'DOWN', Ref, process, Pid, Reason}, _, S = #state{other = Pid, monitor=Ref}) ->\r\n  notice(S, \"Other side dead\", []),\r\n  {stop, {other_down, Reason}, S};\r\n\r\nhandle_info(Info, StateName, Data) ->\r\n  unexpected(Info, StateName),\r\n  {next_state, StateName, Data}.\r\n\r\ncode_change(_OldVsn, StateName, Data, _Extra) ->\r\n  {ok, StateName, Data}.\r\n\r\nterminate(_Reason, _StateName, _StateData) -> ok.\r\n```\r\n<!-- ##{\"timestamp\":1680616800}## -->\u3002", "top": 0, "createdAt": 1680616800, "style": "", "script": "", "createdDate": "2023-04-04", "dateLabelColor": "#A333D0"}, "P3": {"htmlDir": "docs/post/7-tian-yong-Go-cong-ling-shi-xian-Web-kuang-jia-Gee.html", "label": "doing", "labelColor": "#C2DFE4", "postTitle": "7\u5929\u7528Go\u4ece\u96f6\u5b9e\u73b0Web\u6846\u67b6Gee", "postUrl": "post/7-tian-yong-Go-cong-ling-shi-xian-Web-kuang-jia-Gee.html", "postSourceUrl": "https://github.com/fluent12138/fluent12138.github.io/issues/3", "commentNum": 0, "description": "## \u51c6\u5907\u9636\u6bb5\r\n- \u73af\u5883\u642d\u5efa, \u642d\u4e86\u4e24\u4efd\r\n    - \u4f7f\u7528wsl2 ubuntu\u955c\u50cf, \u76f4\u63a5\u547d\u4ee4\u884c\u5b89\u88c5, \u560e\u560e\u5feb\r\n    - windows\u672c\u673a\u5b89\u88c5go,  [\u53c2\u8003\u94fe\u63a5](https://blog.csdn.net/qq_34902437/article/details/120699775) \r\n- ide\r\n    - \u719f\u6089\u8bed\u6cd5\u9636\u6bb5: `vim` (y\u603b\u914d\u7f6e\u560e\u560e\u597d\u7528)\r\n    - \u6b63\u5f0f\u7f16\u5199\u9636\u6bb5: `idea 2021`\r\n- \u7248\u672c\u63a7\u5236: `git`\r\n\r\n## day1\r\n- \u4ee3\u7801\u91cf: `50\u884c`\r\n- \u4e3b\u8981\u5185\u5bb9\r\n    - \u4e86\u89e3go\u4e2dhttp\u6a21\u5757\u7684\u4f5c\u7528\r\n    - \u81ea\u5b9a\u4e49\u8def\u7531 + \u56de\u8c03\u65b9\u6cd5\r\n    - \u6846\u67b6\u7ed3\u6784\u5b9a\u4e49\r\n\r\n**\u6846\u67b6\u57fa\u672c\u7ed3\u6784**\r\n```go\r\n// \u6587\u4ef6\u7ed3\u6784\r\n.\r\n\u251c\u2500\u2500 base1\r\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\r\n\u251c\u2500\u2500 base2\r\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\r\n\u2514\u2500\u2500 base3\r\n    \u251c\u2500\u2500 fgee\r\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 fgee.go\r\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 go.mod\r\n    \u251c\u2500\u2500 go.mod\r\n    \u2514\u2500\u2500 main.go\r\n\r\n// \u53ea\u6709\u4e00\u4e2a\u8def\u7531\u5bf9\u5e94\u7684map\r\n// \u6bd4\u5982\u5b9a\u4e49\u4e86\u4e00\u4e2a\u8def\u7531\u4e3a \"/hello\", \u56de\u8c03\u65b9\u6cd5\u4e3ahelloFunc, \u5c31\u4f1a\u5b58\u5728\u8fd9\u4e2a\u7ed3\u6784\u4f53\u4e2d {\"/hello\" : helloFunc}\r\n// \u5f53\u8bf7\u6c42\u4e86\u8fd9\u4e2a\u8def\u5f84, \u901a\u8fc7\u8def\u5f84\u627e\u5230\u5bf9\u5e94\u65b9\u6cd5, \u7136\u540e\u6267\u884c\r\n\r\ntype Engine struct {\r\n\trouter map[string]HandlerFunc\r\n}\r\n```\r\n\r\n## day2\r\n\r\n- \u603b\u4ee3\u7801\u91cf:\u7ea6`140\u884c`, \u65b0\u589e`90\u884c`\r\n- \u4e3b\u8981\u5185\u5bb9\r\n    - \u5c01\u88c5\u6570\u636e\r\n        - \u5b9a\u4e49\u4e0a\u4e0b\u6587\u5c01\u88c5\u8bf7\u6c42\u8fc7\u7a0b\u9700\u8981\u7684\u6570\u636e\r\n        - \u5c01\u88c5\u8def\u7531\u4e3a\u5355\u72ec\u4e00\u4e2a\u6a21\u5757, `router.go`\r\n    - \u5b9a\u4e49\u901a\u7528\u65b9\u6cd5: \u4f8b\u5982\u54cd\u5e94HTML\u9875\u9762, \u54cd\u5e94\u5b57\u7b26\u4e32, \u54cd\u5e94json\u6570\u636e\r\n\r\n**\u6846\u67b6\u57fa\u672c\u7ed3\u6784**\r\n\r\n```go\r\n// \u6587\u4ef6\u7ed3\u6784\r\n.\r\n\u251c\u2500\u2500 fgee\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 context.go\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 fgee.go\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 go.mod\r\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 router.go\r\n\u251c\u2500\u2500 go.mod\r\n\u2514\u2500\u2500 main.go\r\n\r\n// fgee.go\u6587\u4ef6\r\n\r\ntype Engine struct {\r\n\trouter *router // \u7531\u4e4b\u524d\u7684map\u5c01\u88c5\u4e3a\u7ed3\u6784\u4f53\r\n}\r\n\r\n// context.go\u6587\u4ef6\r\n// Context \u4e0a\u4e0b\u6587\u7ed3\u6784\r\n// \u5728ServeHTTP\u65b9\u6cd5\u4e2d\u88ab\u521b\u5efa\r\n\r\ntype Context struct {\r\n\t// \u8bf7\u6c42\u4e0e\u54cd\u5e94\r\n\tReq    *http.Request\r\n\tWriter http.ResponseWriter\r\n\t// \u8bf7\u6c42\u4fe1\u606f\r\n\tPath   string\r\n\tMethod string\r\n\t// \u54cd\u5e94\u4fe1\u606f\r\n\tStatusCode int\r\n}\r\n\r\n// \u6bcf\u6b21\u8bf7\u6c42\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u5355\u72ec\u7684context, \u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u670d\u52a1\r\n```\r\n\r\n## day3\r\n\r\n- \u603b\u4ee3\u7801\u91cf: \u7ea6`290\u884c` \u65b0\u589e\u4ee3\u7801: \u7ea6`150\u884c`\r\n- \u4e3b\u8981\u5185\u5bb9\r\n    - \u6dfb\u52a0\u52a8\u6001\u8def\u7531, \u4f7f\u7528`\u5b57\u5178\u6811`\r\n    - \u652f\u6301 `:name`\u4e0e`*filepath`\u4e24\u79cd\u6a21\u5f0f\r\n- \u6709\u70b9\u5fd8\u4e86\u5b57\u5178\u6811\u662f\u5565\u4e86, \u5199\u4e4b\u524d\u8fd8\u56de\u987e\u4e86\u4e00\u4e0b\u57fa\u7840\u8bfe\u5b57\u5178\u6811 : )\r\n\r\n **\u5b57\u5178\u6811\u64cd\u4f5c** \r\n \r\n- \u63d2\u5165: \u5bf9\u5e94\u521b\u5efa\u8def\u7531\u65f6, \u628a\u8def\u7531\u63d2\u5165\u5b57\u5178\u6811\u4e2d\r\n- \u67e5\u8be2: \u5f53\u8bf7\u6c42\u6765\u4e34\u65f6, \u53bb\u5b57\u5178\u6811\u627e\u5230\u5bf9\u5e94\u7684\u8def\u7531\r\n\r\n**\u6846\u67b6\u57fa\u672c\u7ed3\u6784**\r\n```go\r\n// \u6587\u4ef6\u7ed3\u6784\r\n.\r\n\u251c\u2500\u2500 fgee\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 context.go\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 fgee.go\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 go.mod\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 router.go\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 router_test.go\r\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tire.go\r\n\u251c\u2500\u2500 go.mod\r\n\u2514\u2500\u2500 main.go\r\n\r\n// context.go\r\n\r\n// Context \u4e0a\u4e0b\u6587\u7ed3\u6784\r\n// \u5728ServeHTTP\u65b9\u6cd5\u4e2d\u88ab\u521b\u5efa\r\ntype Context struct {\r\n\t// \u8bf7\u6c42\u4e0e\u54cd\u5e94\r\n\tReq    *http.Request\r\n\tWriter http.ResponseWriter\r\n\t// \u8bf7\u6c42\u4fe1\u606f\r\n\tPath   string\r\n\tMethod string\r\n\t// \u8def\u7531\u5339\u914d\u540e\u7684\u53c2\u6570\r\n\tParams map[string]string\r\n\t// \u54cd\u5e94\u4fe1\u606f\r\n\tStatusCode int\r\n}\r\n```\r\n- \u5b58\u5728\u95ee\u9898: \u5b57\u5178\u6811\u5904\u7406\u4e0d\u4e25\u8c28, \u8def\u7531\u4f1a\u51b2\u7a81, \u6bd4\u5982\u521b\u5efa\u8def\u7531/:age, \u518d\u521b\u5efa\u8def\u7531/16, \u8fd9\u6837\u5c31\u4f1a\u51fa\u73b0\u51b2\u7a81\u95ee\u9898\r\n\r\n\r\n**\u6559\u7a0b\u94fe\u63a5**\r\n\r\n> [7\u5929\u7528Go\u4ece\u96f6\u5b9e\u73b0Web\u6846\u67b6Gee\u6559\u7a0b](https://geektutu.com/post/gee.html)\u3002", "top": 0, "createdAt": 1710058926, "style": "", "script": "", "createdDate": "2024-03-10", "dateLabelColor": "#bc4c00"}}, "singeListJson": {"P2": {"htmlDir": "docs/about.html", "label": "about", "labelColor": "#37508E", "postTitle": "\u5173\u4e8e", "postUrl": "post/guan-yu.html", "postSourceUrl": "https://github.com/fluent12138/fluent12138.github.io/issues/2", "commentNum": 0, "description": "## \u4e00\u4e2a\u6b63\u5728\u52aa\u529b\u751f\u6d3b\u7684\u4eba\r\n\r\n- \u6b63\u5728\u7528\u7684\u5403\u996d\u7684\u5bb6\u4f19\r\n    - Erlang\r\n- \u4ee5\u540e\u53ef\u80fd\u4f1a\u8ba9\u6211\u5403\u4e0a\u996d\u7684\u5bb6\u4f19\r\n    - Go\u3001Java\r\n    \r\n**\u5e0c\u671b\u5927\u5bb6\u90fd\u80fd\u597d\u597d\u5403\u996d\uff01**\u3002", "top": 0, "createdAt": 1710058738, "style": "", "script": "", "createdDate": "2024-03-10", "dateLabelColor": "#bc4c00"}}, "prevUrl": "disabled", "nextUrl": "disabled"}